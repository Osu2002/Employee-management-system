import{L as D,D as I,J as b,o as r,e as h,w as p,f as e,g,i as f,C as i,s as c,x as A,j as a,K as d,N as S,E as w,F as C,G as m,M as V,q as x}from"./index-QC1Cz5ZB.js";import{A as E}from"./AppLayout-C2fcH5kv.js";import{F as R}from"./FileInputComponent-LsIVWHfz.js";import{S as N}from"./SideNavBar-Do_6nNue.js";import{b as F}from"./browser-CeceZ__e.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={components:{Link:D,AppLayout:E,FileInputComponent:R,SelectInputComponent:N},props:{errors:Object,employee:Object,employeeUrl:String,isMultiple:{type:Boolean,default:!1},jobRoles:Array},data(){return{form:I({id:"",name:"",email:"",personal_email:"",designation:"",join_date:"",end_date:"",status:"",nic:"",phone:"",home_telephone:"",birthday:"",address:"",leave_types:[],profile_image:"",password:"",password_confirmation:""}),qrCodeData:"",qrCodeImageUrl:"",showPassword:!1,showPasswordConfirm:!1}},mounted(){this.employee&&(this.generateQRCode(),this.form.id=this.employee.id,this.form.emp_id="EMP"+(this.employee.id+5e3),this.form.name=this.employee.name,this.form.email=this.employee.email,this.form.designation=this.employee.designation,this.form.join_date=this.employee.join_date,this.form.end_date=this.employee.end_date,this.form.status=this.employee.status,this.form.personal_email=this.employee.personal_email,this.form.nic=this.employee.nic,this.form.home_telephone=this.employee.home_telephone,this.form.birthday=this.employee.birthday,this.form.address=this.employee.address,this.form.phone=this.employee.phone,this.jobRoles.find(l=>l.id===this.form.designation),this.form.leave_types=this.employee.leave_types)},computed:{profileImage(){var l,o;return((o=(l=this.employee)==null?void 0:l.media.find(n=>["employee_profil_image","employee_profile_image"].includes(n.collection_name)))==null?void 0:o.original_url)||""}},watch:{"form.leave_types":{handler(l){l&&Array.isArray(l)&&l.forEach(o=>{o.available_leaves=o.user_allowed_leaves-o.used_leaves})},deep:!0}},methods:{togglePasswordVisibility(){this.showPassword=!this.showPassword},togglePasswordConfirmVisibility(){this.showPasswordConfirm=!this.showPasswordConfirm},onDesignationChange(){const l=this.jobRoles.find(o=>o.id===this.form.designation);l&&l.leave_types?this.form.leave_types=l.leave_types.map(o=>{let n=0;return this.form.leave_types&&(n=this.form.leave_types.find(v=>v.type===o.type)),{type:o.type,default_allowed_leaves:o.default_allowed_leaves||0,allowed_leaves:(n==null?void 0:n.allowed_leaves)||o.allowed_leaves||o.default_allowed_leaves||0,used_leaves:(n==null?void 0:n.used_leaves)||o.used_leaves||0,available_leaves:((n==null?void 0:n.allowed_leaves)||o.allowed_leaves||o.default_allowed_leaves||0)-((n==null?void 0:n.used_leaves)||o.used_leaves||0)}}):this.form.leave_types=[]},generateQRCode(){const l=JSON.stringify(this.employeeUrl);this.qrCodeData=l,F.toDataURL(l,{width:180,height:150}).then(o=>{this.qrCodeImageUrl=o}).catch(o=>{console.error("Error generating QR code:",o)})},submit(){const l={...this.form,leave_types:this.form.leave_types.map(o=>({type:o.type,default_allowed_leaves:o.default_allowed_leaves,allowed_leaves:o.allowed_leaves,used_leaves:o.used_leaves,available_leaves:o.available_leaves}))};console.log("Submitting payload:",l),this.form.post(this.employee?route("employee.update",l):route("employee.store",l))}}},B={class:"row"},L={class:"col-md-12"},Q={class:"card mb-4"},J={class:"card-header pb-0"},O={class:"col-12 mb-4"},T={class:"row"},z={class:"col-1"},G=e("i",{class:"back-icon fas fa-arrow-left p-2"},null,-1),H={key:0,class:"col-11 d-flex justify-content-end"},K={class:"m-0 text-center"},W=e("h5",null,"Employee",-1),X=e("p",null,"Manage Employee Details",-1),Y={class:"card-body"},Z={class:"row"},$={class:"mb-3 col-md-6"},ee=e("label",{for:"name",class:"form-label"},"Employee Index:",-1),oe={class:"text-danger"},se={class:"mb-3 col-md-6"},te=e("label",{for:"name",class:"form-label"},"Full Name:",-1),le={class:"text-danger"},ne={class:"mb-3 col-md-6"},ie=e("label",{for:"email",class:"form-label"},"Weblook Email:",-1),re={class:"text-danger"},ae={class:"mb-3 col-md-6"},de=e("label",{for:"personal_email",class:"form-label"},"Personal Email:",-1),me={class:"text-danger"},_e={class:"mb-3 col-md-6"},pe=e("label",{for:"designation",class:"form-label"},"Designation:",-1),fe=e("option",{value:""}," -- Select Designation -- ",-1),ce=["value"],ue={class:"text-danger"},he={class:"mb-3 col-md-6",action:"/action_page.php"},ye=e("label",{for:"join_date"},"Join Date:",-1),be={class:"text-danger"},ge={class:"mb-3 col-md-6",action:"/action_page.php"},ve=e("label",{for:"end _date"},"End Date:",-1),we={class:"text-danger"},Ce={class:"mb-3 col-md-6"},Ve=e("label",{for:"nic",class:"form-label"},"NIC:",-1),xe={class:"text-danger"},Ue={class:"mb-3 col-md-6"},ke=e("label",{for:"phone",class:"form-label"},"Phone Number:",-1),Pe={class:"text-danger"},je={class:"mb-3 col-md-6"},De=e("label",{for:"home_telephone",class:"form-label"},"Home Telephone Line:",-1),Ie={class:"text-danger"},Ae={class:"mb-3 col-md-6"},Se=e("label",{for:"birthday",class:"form-label"},"Birthday:",-1),Ee={class:"text-danger"},Re={class:"mb-3 col-md-6"},Ne=e("label",{for:"address",class:"form-label"},"Address:",-1),Fe={class:"text-danger"},qe={class:"mb-3 col-md-6"},Me=e("label",{for:"leave_types",class:"form-label"},"Leave Types and Count:",-1),Be={key:0},Le={class:"list-group"},Qe={class:"d-flex flex-column"},Je=e("strong",null,"Type:",-1),Oe=e("strong",null," Default Allowed: ",-1),Te=e("strong",null," Allowed Leaves: ",-1),ze=e("strong",null," Used Leaves: ",-1),Ge=e("strong",null," Available Leaves: ",-1),He=["onUpdate:modelValue"],Ke={key:0,class:"text-danger"},We={key:1},Xe=e("span",{class:"text-muted"}," No leave types available for this designation. ",-1),Ye=[Xe],Ze={class:"mb-3 col-md-6"},$e=e("label",{for:"profile_image",class:"form-label me-3"},"Profile Image:",-1),eo=e("br",null,null,-1),oo={class:"text-danger"},so=e("br",null,null,-1),to=e("h5",null,"Authentication",-1),lo={class:"mb-3 col-md-6"},no=e("label",{for:"password",class:"form-label"},"Password:",-1),io={class:"input-group"},ro=["type"],ao={class:"text-danger"},mo={class:"mb-3 col-md-6"},_o=e("label",{for:"password_confirmation",class:"form-label"},"Confirm Password:",-1),po={class:"input-group"},fo=["type"],co={class:"text-danger"},uo={key:0},ho=["src"],yo={class:"mt-2"},bo=["disabled"],go=m("Cancel"),vo=m("Document"),wo=m("Leaves"),Co=m("Certificate"),Vo=m("Bank Details"),xo=m("Service Letter"),Uo=m("Projects");function ko(l,o,n,v,s,_){const u=b("Link"),U=b("SelectInputComponent"),k=b("FileInputComponent"),P=b("AppLayout");return r(),h(P,null,{default:p(()=>[e("div",B,[e("div",L,[e("div",Q,[e("div",J,[e("div",O,[e("div",T,[e("div",z,[g(u,{class:"back-button",href:l.route("employee",s.form.id)},{default:p(()=>[G]),_:1},8,["href"])]),n.employee?(r(),f("div",H,[e("h5",K,i(n.employee.name),1)])):c("",!0)])]),W,X]),e("div",Y,[e("form",{id:"formAccountSettings",onSubmit:o[19]||(o[19]=A((...t)=>_.submit&&_.submit(...t),["prevent"]))},[e("div",Z,[e("div",$,[ee,a(e("input",{class:"form-control",type:"text",id:"emp_id",name:"emp_id","onUpdate:modelValue":o[0]||(o[0]=t=>s.form.emp_id=t),disabled:""},null,512),[[d,s.form.emp_id]]),e("div",oe,i(s.form.errors.name),1)]),e("div",se,[te,a(e("input",{class:"form-control",type:"text",id:"name",name:"name","onUpdate:modelValue":o[1]||(o[1]=t=>s.form.name=t)},null,512),[[d,s.form.name]]),e("div",le,i(s.form.errors.name),1)]),e("div",ne,[ie,a(e("input",{class:"form-control",type:"email",id:"email",name:"email","onUpdate:modelValue":o[2]||(o[2]=t=>s.form.email=t)},null,512),[[d,s.form.email]]),e("div",re,i(s.form.errors.email),1)]),e("div",ae,[de,a(e("input",{class:"form-control",type:"email",id:"personal_email",name:"personal_email","onUpdate:modelValue":o[3]||(o[3]=t=>s.form.personal_email=t)},null,512),[[d,s.form.personal_email]]),e("div",me,i(s.form.errors.personal_email),1)]),e("div",_e,[pe,a(e("select",{class:"form-control",id:"designation",name:"designation","onUpdate:modelValue":o[4]||(o[4]=t=>s.form.designation=t),onChange:o[5]||(o[5]=(...t)=>_.onDesignationChange&&_.onDesignationChange(...t))},[fe,(r(!0),f(C,null,w(n.jobRoles,t=>(r(),f("option",{key:t.id,value:t.id},i(t.name),9,ce))),128))],544),[[S,s.form.designation]]),e("div",ue,i(s.form.errors.designation),1)]),g(U,{id:"status",label:"Status",error:s.form.errors.status,options:[{id:"1",name:"Active"},{id:"0",name:"Inactive"}],modelValue:s.form.status,"onUpdate:modelValue":o[6]||(o[6]=t=>s.form.status=t)},null,8,["error","modelValue"]),e("div",he,[ye,a(e("input",{class:"form-control",type:"date",id:"join_date",name:"join_date","onUpdate:modelValue":o[7]||(o[7]=t=>s.form.join_date=t)},null,512),[[d,s.form.join_date]]),e("div",be,i(s.form.errors.join_date),1)]),e("div",ge,[ve,a(e("input",{class:"form-control",type:"date",id:"end _date",name:"end _date","onUpdate:modelValue":o[8]||(o[8]=t=>s.form.end_date=t)},null,512),[[d,s.form.end_date]]),e("div",we,i(s.form.errors.end_date),1)]),e("div",Ce,[Ve,a(e("input",{class:"form-control",type:"text",id:"text",name:"nic","onUpdate:modelValue":o[9]||(o[9]=t=>s.form.nic=t)},null,512),[[d,s.form.nic]]),e("div",xe,i(s.form.errors.nic),1)]),e("div",Ue,[ke,a(e("input",{class:"form-control",type:"text",id:"phone",name:"phone","onUpdate:modelValue":o[10]||(o[10]=t=>s.form.phone=t)},null,512),[[d,s.form.phone]]),e("div",Pe,i(s.form.errors.phone),1)]),e("div",je,[De,a(e("input",{class:"form-control",type:"text",id:"home_telephone",name:"home_telephone","onUpdate:modelValue":o[11]||(o[11]=t=>s.form.home_telephone=t)},null,512),[[d,s.form.home_telephone]]),e("div",Ie,i(s.form.errors.home_telephone),1)]),e("div",Ae,[Se,a(e("input",{class:"form-control",type:"date",id:"birthday",name:"birthday","onUpdate:modelValue":o[12]||(o[12]=t=>s.form.birthday=t)},null,512),[[d,s.form.birthday]]),e("div",Ee,i(s.form.errors.birthday),1)]),e("div",Re,[Ne,a(e("input",{class:"form-control",type:"text",id:"address",name:"address","onUpdate:modelValue":o[13]||(o[13]=t=>s.form.address=t)},null,512),[[d,s.form.address]]),e("div",Fe,i(s.form.errors.address),1)]),e("div",qe,[Me,s.form.leave_types&&s.form.leave_types.length>0?(r(),f("div",Be,[e("ul",Le,[(r(!0),f(C,null,w(s.form.leave_types,(t,y)=>(r(),f("li",{key:y,class:"list-group-item d-flex justify-content-between align-items-center"},[e("div",Qe,[e("span",null,[Je,m(" "+i(t.type),1)]),e("span",null,[Oe,m(" "+i(t.allowed_leaves),1)]),e("span",null,[Te,m(" "+i(t.user_allowed_leaves),1)]),e("span",null,[ze,m(" "+i(t.used_leaves),1)]),e("span",null,[Ge,m(" "+i(t.available_leaves),1)])]),e("div",null,[a(e("input",{type:"text","onUpdate:modelValue":j=>s.form.leave_types[y].user_allowed_leaves=j,class:"form-control form-control-sm w-auto",placeholder:"Allowed Days"},null,8,He),[[d,s.form.leave_types[y].user_allowed_leaves]]),n.errors[`leave_types.${y}.user_allowed_leaves`]?(r(),f("div",Ke," Please enter valid number ")):c("",!0)])]))),128))])])):(r(),f("div",We,Ye))]),e("div",Ze,[$e,eo,g(k,{isRequired:!1,id:"profile_image",prvImage:_.profileImage,modelValue:s.form.profile_image,"onUpdate:modelValue":o[14]||(o[14]=t=>s.form.profile_image=t)},null,8,["prvImage","modelValue"]),e("div",oo,i(s.form.errors.profile_image),1)]),so,to,e("div",lo,[no,e("div",io,[a(e("input",{type:s.showPassword?"text":"password",class:"form-control",id:"password",name:"password","onUpdate:modelValue":o[15]||(o[15]=t=>s.form.password=t)},null,8,ro),[[V,s.form.password]]),e("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[16]||(o[16]=(...t)=>_.togglePasswordVisibility&&_.togglePasswordVisibility(...t))},[e("i",{class:x(s.showPassword?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),e("div",ao,i(s.form.errors.password),1)]),e("div",mo,[_o,e("div",po,[a(e("input",{type:s.showPasswordConfirm?"text":"password",class:"form-control",id:"password_confirmation",name:"password_confirmation","onUpdate:modelValue":o[17]||(o[17]=t=>s.form.password_confirmation=t)},null,8,fo),[[V,s.form.password_confirmation]]),e("button",{type:"button",class:"btn btn-outline-secondary",onClick:o[18]||(o[18]=(...t)=>_.togglePasswordConfirmVisibility&&_.togglePasswordConfirmVisibility(...t))},[e("i",{class:x(s.showPasswordConfirm?"fas fa-eye-slash":"fas fa-eye")},null,2)])]),e("div",co,i(s.form.errors.password_confirmation),1)]),n.employee?(r(),f("div",uo,[e("img",{src:s.qrCodeImageUrl,alt:"QR Code"},null,8,ho)])):c("",!0)]),e("div",yo,[e("button",{type:"submit",class:"btn btn-main me-2",disabled:s.form.processing},i(n.employee?"Update":"Save"),9,bo),g(u,{class:"btn btn-outline-danger",href:l.route("employee",s.form.id),style:{"margin-right":"10px"}},{default:p(()=>[go]),_:1},8,["href"]),n.employee?(r(),h(u,{key:0,type:"button",href:l.route("employee.document",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[vo]),_:1},8,["href"])):c("",!0),n.employee?(r(),h(u,{key:1,type:"button",href:l.route("employee.leaves.index",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[wo]),_:1},8,["href"])):c("",!0),n.employee?(r(),h(u,{key:2,type:"button",href:l.route("employee.certificate",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[Co]),_:1},8,["href"])):c("",!0),n.employee?(r(),h(u,{key:3,type:"button",href:l.route("employee.bank_details",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[Vo]),_:1},8,["href"])):c("",!0),n.employee?(r(),h(u,{key:4,type:"button",href:l.route("employee.service_letter",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[xo]),_:1},8,["href"])):c("",!0),n.employee?(r(),h(u,{key:5,type:"button",href:l.route("admin.projects",s.form.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:p(()=>[Uo]),_:1},8,["href"])):c("",!0)])],32)])])])])]),_:1})}const Eo=q(M,[["render",ko]]);export{Eo as default};
