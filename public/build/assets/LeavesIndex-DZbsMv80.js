import{L as _,D as b,J as d,o as n,e as m,w as c,f as e,g as h,C as f,s as y,x as v,G as k}from"./index-QC1Cz5ZB.js";import{A as g}from"./AppLayout-C2fcH5kv.js";import{D as w}from"./DataTable-Err4qTG9.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SideNavBar-Do_6nNue.js";const S={components:{Link:_,AppLayout:g,DataTable:w},props:{employee:{type:Object,required:!0}},data(){return{columns:[{data:"check",name:"check",orderable:!1,searchable:!1},{data:"from_date",name:"from_date",orderable:!0,searchable:!0},{data:"to",name:"to",orderable:!0,searchable:!0},{data:"leave_type",name:"leave_type",orderable:!0,searchable:!0},{data:"type",name:"type",orderable:!0,searchable:!0},{data:"status",name:"status",orderable:!0},{data:"action",name:"action",orderable:!0}],columnDefs:[{className:"text-center",targets:[]}],order:[[1,"desc"]],form:b({id:"",status:"",employee_id:""})}},mounted(){$("#mytable tbody").on("click","tr .action_delete",t=>{const s=$(t.target).data("item-id"),o=$(t.target).data("emp-id");this.form.employee_id=o,this.selectedRows=[],this.getSelectedItems(s)}),$("#mytable tbody").on("click","tr .action_edit",t=>{const s=$(t.target).data("item-id"),o=$(t.target).data("emp-id");this.$inertia.visit(route("employee.leaves.edit",{empid:o,id:s}))}),$("#mytable tbody").on("click","tr .action_status_change",t=>{const s=$(t.target).data("item-id"),o=$(t.target).data("status");this.updateStatus(s,o)}),$("#mytable tbody").on("click",".item-check input[type=checkbox]",t=>{const s=$(t.target).val();$(t.target).prop("checked")&&!this.selectedRows.includes(s)?this.getSelectedItems(s):this.removeUnselectedItem(s)})},methods:{reloadTable(){this.$refs.datatable.reloadDatatable()},getSelectedItems(t){this.selectedRows.push(t),this.selectedRows.length>0&&(this.$data.isDisabled=!1)},selectAll(t){var s=this;$(t.target).is(":checked")?($(".item-check input[type=checkbox]").prop("checked",!0),$(".item-check input[type=checkbox]:checked").each(function(){s.selectedRows.includes(this.value)||s.getSelectedItems(this.value)}),this.$data.isDisabled=!1):($(".item-check input[type=checkbox]").prop("checked",!1),$(".item-check input[type=checkbox]").each(function(){s.selectedRows.includes(this.value)&&s.removeUnselectedItem(this.value)}),this.$data.isDisabled=!0)},removeUnselectedItem(t){this.selectedRows=this.selectedRows.filter(function(s){return s!=t}),this.selectedRows.length<=0&&($("#selectAll").prop("checked",!1),this.$data.isDisabled=!0)},updateStatus(t,s){this.form.id=t,this.form.status=s,this.form.put(route("employee.change.status"),{preserveScroll:!0,onSuccess:()=>{this.form.reset(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Staus Updated Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})},deleteSelectedItems(){this.form.transform(t=>({...t,ids:[...this.selectedRows]})).post(route("employee.leaves.destroy"),{onSuccess:()=>{this.resetForm(),this.reloadTable(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")},onFinish:()=>{$("#deleteConfirm").modal("hide"),this.resetForm()}})},resetForm(){this.form.reset("id","status")}}},D={class:"row"},A={class:"col-md-12"},L={class:"card mb-4"},C={class:"card-header pb-0"},I={class:"col-12 mb-4"},R={class:"row"},F={class:"col-1"},M=e("i",{class:"back-icon fas fa-arrow-left p-2"},null,-1),T={class:"col-11 d-flex justify-content-end"},E={class:"m-0 text-center"},N=e("h5",null,"Employee Leaves",-1),V=e("p",null,"Manage Employee Leaves.",-1),U={class:"d-flex"},B=e("i",{class:"bx bx-plus"},null,-1),j=k(" Create "),Y={class:"card-body"},q={width:"10%"},G={class:"custom-control custom-checkbox"},J=e("label",{class:"form-check-label",for:"selectAll"},null,-1),O=e("th",null,"Date",-1),P=e("th",null,"To",-1),W=e("th",null,"Leave Type",-1),z=e("th",null,"Leave Duration",-1),H=e("th",null,"Status",-1),K=e("th",null,"Action",-1),Q={class:"modal modal-top fade",id:"deleteConfirm",tabindex:"-1","aria-hidden":"true","data-bs-backdrop":"false"},X={class:"modal-dialog modal-sm",role:"document"},Z={class:"modal-content"},ee=e("div",{class:"modal-header px-3 pb-2"},[e("h5",{class:"modal-title",id:"exampleModalLabel2"}," Are You Sure? ")],-1),te=e("div",{class:"modal-body py-0 px-3"},[e("div",{class:"row"},[e("div",{class:"col mb-1"},[e("p",null,"Are you sure you want to delete?")])])],-1),se={class:"modal-footer px-3 pb-3"},oe=e("button",{type:"submit",class:"btn btn-sm btn-primary"}," Yes ",-1);function ae(t,s,o,le,r,a){const i=d("Link"),u=d("data-table"),p=d("AppLayout");return n(),m(p,null,{default:c(()=>[e("div",D,[e("div",A,[e("div",L,[e("div",C,[e("div",I,[e("div",R,[e("div",F,[h(i,{class:"back-button",href:t.route("employee.edit",o.employee.id)},{default:c(()=>[M]),_:1},8,["href"])]),e("div",T,[e("h5",E,f(o.employee.name),1)])])]),N,V,e("div",U,[t.$root.hasPermission("employee.leaves")?(n(),m(i,{key:0,class:"btn btn-main btn-sm",href:t.route("employee.leaves.create",o.employee.id)},{default:c(()=>[B,j]),_:1},8,["href"])):y("",!0)])]),e("div",Y,[h(u,{ref:"datatable",id:"mytable",url:t.route("employee.leaves.getdata",o.employee.id),columns:r.columns,columnDefs:r.columnDefs},{header:c(()=>[e("tr",null,[e("th",q,[e("div",G,[e("input",{type:"checkbox",class:"form-check-input",id:"selectAll",onClick:s[0]||(s[0]=l=>a.selectAll(l))}),J])]),O,P,W,z,H,K])]),_:1},8,["url","columns","columnDefs"])])])]),e("div",Q,[e("div",X,[e("div",Z,[ee,e("form",{id:"formAccountDelete",onSubmit:s[2]||(s[2]=v((...l)=>a.deleteSelectedItems&&a.deleteSelectedItems(...l),["prevent"]))},[te,e("div",se,[e("button",{type:"button",class:"btn btn-sm btn-label-secondary","data-bs-dismiss":"modal",onClick:s[1]||(s[1]=(...l)=>a.resetForm&&a.resetForm(...l))}," Close "),oe])],32)])])])])]),_:1})}const me=x(S,[["render",ae]]);export{me as default};
