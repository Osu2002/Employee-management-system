import{A as N}from"./AppLayout-68SlFB6E.js";import{S as g}from"./sweetalert2.all-R2NmH7ql.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{J as k,o as l,e as B,w as D,f as e,C as i,i as n,F as b,E as x,s as C,q as L,O as I,P as T}from"./index-QC1Cz5ZB.js";import"./SideNavBar-Do_6nNue.js";const E={components:{AppLayout:N},props:{employee_id:Number,errors:Object,employee_data:Object,leave_data:Array,document_data:Array},data(){var t;return{employee_id:((t=this.employee_data)==null?void 0:t.id)||null,localLeaveData:this.leave_data?[...this.leave_data]:[],menuOpen:!1,coverPhoto:"",defaultCoverPhoto:"/images/background6.png"}},computed:{employee_id(){var t;return((t=this.employee_data)==null?void 0:t.id)||null},profileDetails(){var t,s,o,f,h,_,c,u,p,r,m,d;return{"Full Name":((t=this.employee_data)==null?void 0:t.name)||"N/A",Email:((s=this.employee_data)==null?void 0:s.email)||"N/A","Personal Email":((o=this.employee_data)==null?void 0:o.personal_email)||"N/A",Designation:((h=(f=this.employee_data)==null?void 0:f.job_role)==null?void 0:h.name)||"N/A",NIC:((_=this.employee_data)==null?void 0:_.nic)||"N/A","Home Telephone Line":((c=this.employee_data)==null?void 0:c.home_telephone)||"N/A",Birthday:((u=this.employee_data)==null?void 0:u.birthday)||"N/A",Address:((p=this.employee_data)==null?void 0:p.address)||"N/A",Phone:((r=this.employee_data)==null?void 0:r.phone)||"N/A","Join Date":((m=this.employee_data)==null?void 0:m.join_date)||"N/A","End Date":((d=this.employee_data)==null?void 0:d.end_date)||"N/A"}}},mounted(){this.fetchCoverPhoto()},methods:{triggerFileInput(){this.$refs.fileInput.click()},async uploadCoverPhoto(t){const s=t.target.files[0];if(!s)return;if(!["image/jpeg","image/png","image/jpg","image/webp"].includes(s.type)){alert("Invalid file type. Please upload a JPEG or PNG image.");return}const f=2*1024*1024;if(s.size>f){alert("File size exceeds the 2MB limit. Please upload a smaller file.");return}const h=new FileReader;h.onload=async _=>{const c=new Image;c.src=_.target.result,c.onload=async()=>{var m;if(c.width>1140||c.height>300){alert("Image dimensions exceed the allowed size (1140x300px). Please resize your image.");return}const r=new FormData;r.append("employee_id",this.employee_data.id),r.append("cover_photo",s);try{const d=await axios.post("/upload-cover-photo",r,{headers:{"Content-Type":"multipart/form-data"}});this.coverPhoto=d.data.cover_photo,location.reload()}catch(d){console.error("Upload failed",((m=d.response)==null?void 0:m.data)||d.message)}}},h.readAsDataURL(s)},async fetchCoverPhoto(){try{const t=await axios.get(`/employee/${this.employee_id}`);this.coverPhoto=t.data.cover_photo_url}catch(t){console.error(t.response.data.error||"Failed to fetch data")}},toggleMenu(){this.menuOpen=!this.menuOpen},handleSelection(){this.selectedOption==="apply"?this.applyLeave():this.selectedOption==="contact"&&this.contactHR(),this.selectedOption=""},applyLeave(){g.fire({title:"Apply for Leave",text:"Would you like to proceed with leave application?",icon:"question",showCancelButton:!0,confirmButtonText:"Yes, Apply",cancelButtonText:"No, Cancel"}).then(t=>{t.isConfirmed&&this.$inertia.visit("/employee/leaves")})},contactHR(){g.fire({title:"Contact HR",text:"Would you like to contact HR?",icon:"info",showCancelButton:!0,confirmButtonText:"Yes, Contact",cancelButtonText:"No, Cancel"}).then(t=>{t.isConfirmed&&this.$inertia.visit("/contact-hr")})},editLeave(t){this.$inertia.visit(`/employee/leaves/${t.id}/edit`)},cancelLeave(t){g.fire({title:"Are you sure?",text:"You won't be able to recover this leave request!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!",cancelButtonText:"No, keep it"}).then(s=>{s.isConfirmed&&this.$inertia.delete(route("employee.leaves.cancel",t.id),{onSuccess:()=>{this.localLeaveData=this.localLeaveData.filter(o=>o.id!==t.id),g.fire("Canceled!","Your leave request has been canceled.","success")},onError:o=>{g.fire("Error!",o.error||"An error occurred while canceling the leave.","error")}})})}}},y=t=>(I("data-v-673d29be"),t=t(),T(),t),F={class:"container"},S={class:"main-body"},j={class:"row gutters-sm"},H={class:"cover-photo-container mb-3"},O=["src"],R={class:"profile-info-corner"},z={class:"profile-photo-container"},W=["src"],Y={class:"profile-details"},q={class:"profile-name"},J={class:"profile-email"},U={class:"profile-role"},V={key:0,class:"col-md-12"},G={class:"card mb-3"},M={class:"card-body"},Q=y(()=>e("h5",{class:"mb-3"},"Employee Profile",-1)),K={class:"table-responsive"},X={class:"table table-bordered"},Z=y(()=>e("thead",null,[e("tr",null,[e("th",null,"Field"),e("th",null,"Details")])],-1)),$={key:1,class:"col-12"},ee={class:"mb-3"},te={class:"card h-100"},oe={class:"card-body"},ae=y(()=>e("h6",{class:"mb-3"},"Documents",-1)),se={class:"table-responsive"},ie={class:"table table-bordered"},le=y(()=>e("thead",null,[e("tr",null,[e("th",null,"Upload Date"),e("th",null,"Document Name"),e("th",null,"Action")])],-1)),ne=["href"],de={key:2,class:"col-12"},ce={class:"mb-3"},re={class:"card shadow-sm rounded-3"},he=y(()=>e("div",{class:"card-header bg-light d-flex justify-content-between align-items-center"},[e("h5",{class:"mb-0 text-dark"}," Leave Applications ")],-1)),_e={class:"card-body p-4"},me={class:"table-responsive"},ue={class:"table table-hover align-middle custom-table"},pe=y(()=>e("thead",{class:"custom-thead"},[e("tr",null,[e("th",{class:"text-center"}," From "),e("th",{class:"text-center"}," To "),e("th",{class:"text-center"}," Leave Type "),e("th",{class:"text-center"}," Duration "),e("th",{class:"text-center"}," Status "),e("th",{class:"text-center"}," Instructions ")])],-1)),ye={class:"text-center"},fe={class:"text-center"},ve={class:"text-center"},ge={class:"text-center"},be={class:"text-center"},xe={class:"text-center"},Ce={key:0,class:"bg-light p-2 rounded"},Ae={key:1,class:"text-muted fst-italic"};function we(t,s,o,f,h,_){const c=k("AppLayout");return l(),B(c,null,{default:D(()=>{var u,p,r,m,d,A;return[e("div",null,[e("div",F,[e("div",S,[e("div",j,[e("div",H,[e("img",{src:h.coverPhoto||h.defaultCoverPhoto,alt:"Cover Photo",class:"cover-photo"},null,8,O),e("input",{type:"file",ref:"fileInput",accept:"image/*",onChange:s[0]||(s[0]=(...a)=>_.uploadCoverPhoto&&_.uploadCoverPhoto(...a)),style:{display:"none"}},null,544),e("div",R,[e("div",z,[e("img",{src:(u=o.employee_data)!=null&&u.media&&((p=o.employee_data)==null?void 0:p.media.length)>0?o.employee_data.media[0].original_url:"/images/blank-profile-picture.webp",alt:"Profile Image",class:"profile-photo"},null,8,W)]),e("div",Y,[e("h4",q,i(((r=o.employee_data)==null?void 0:r.name)||"N/A"),1),e("p",J,i(((m=o.employee_data)==null?void 0:m.email)||"N/A"),1),e("p",U,i(((A=(d=o.employee_data)==null?void 0:d.job_role)==null?void 0:A.name)||"Employee"),1)])])]),o.employee_data?(l(),n("div",V,[e("div",G,[e("div",M,[Q,e("div",K,[e("table",X,[Z,e("tbody",null,[(l(!0),n(b,null,x(_.profileDetails,(a,v)=>(l(),n("tr",{key:v},[e("td",null,[e("strong",null,i(v),1)]),e("td",null,i(a),1)]))),128))])])])])])])):C("",!0),o.document_data&&o.document_data.length>0?(l(),n("div",$,[e("div",ee,[e("div",te,[e("div",oe,[ae,e("div",se,[e("table",ie,[le,e("tbody",null,[(l(!0),n(b,null,x(o.document_data,a=>{var v,w;return l(),n("tr",{key:a.id},[e("td",null,i(a.upload_date),1),e("td",null,i(a.document_name),1),e("td",null,[e("a",{href:(w=(v=a.media)==null?void 0:v[0])==null?void 0:w.original_url,class:"btn btn-secondary btn-sm",target:"_blank"}," View ",8,ne)])])}),128))])])])])])])])):C("",!0),o.leave_data&&o.leave_data.length>0?(l(),n("div",de,[e("div",ce,[e("div",re,[he,e("div",_e,[e("div",me,[e("table",ue,[pe,e("tbody",null,[(l(!0),n(b,null,x(o.leave_data,a=>(l(),n("tr",{key:a.id},[e("td",ye,i(a.from_date),1),e("td",fe,i(a.to_date),1),e("td",ve,i(a.leave_type),1),e("td",ge,i(a.duration),1),e("td",be,[e("span",{class:L({"badge bg-warning text-dark":a.status==="Pending","badge bg-success text-white":a.status==="Approved","badge bg-danger text-white":a.status==="Rejected"})},i(a.status),3)]),e("td",xe,[a.instructions?(l(),n("div",Ce,i(a.instructions),1)):(l(),n("div",Ae," No instructions provided "))])]))),128))])])])])])])])):C("",!0)])])])])]}),_:1})}const Le=P(E,[["render",we],["__scopeId","data-v-673d29be"]]);export{Le as default};
