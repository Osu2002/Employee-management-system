import{L as g,D as y,a as b,J as l,o as m,e as u,w as i,f as t,g as c,C as p,x as v,s as w,G as h}from"./index-QC1Cz5ZB.js";import{A as S}from"./AppLayout-C2fcH5kv.js";import{h as k}from"./html2pdf-C1PPJNF9.js";import{E as C}from"./Editor-i6n_uABq.js";import{b as E}from"./browser-CeceZ__e.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./SideNavBar-Do_6nNue.js";const L={components:{Link:g,AppLayout:S,Editor:C},props:{errors:Object,employee:Object,employeeUrl:Object,service_letter_data:Object},data(){return{form:y({id:"",editorContent:this.service_letter_data?this.service_letter_data.letter:"",employee_id:this.employee.id}),qrCodeData:"",qrCodeImageUrl:""}},computed:{formattedDate(){const e=new Date,s={year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("en-US",s)}},mounted(){this.service_letter_data&&(this.form.id=this.service_letter_data.id,this.form.editorContent=this.service_letter_data.letter),this.employeeUrl?this.generateQRCode():console.error("Employee URL is missing, QR code cannot be generated.")},methods:{generateQRCode(){const e=JSON.stringify(this.employeeUrl);this.qrCodeData=e,E.toDataURL(e,{width:180,height:150}).then(s=>{this.qrCodeImageUrl=s}).catch(s=>{console.error("Error generating QR code:",s)})},toggleVisibility(){b.post("/backend/get-service-letter-visibility",{status:!this.isVisible}).then(e=>{console.log("Visibility updated successfully:",e.data),this.isVisible=!this.isVisible,alert(e.data.message||"Visibility updated successfully.")}).catch(e=>{e.response?(console.error("Error response:",{data:e.response.data,status:e.response.status,headers:e.response.headers}),e.response.status===404?alert("Endpoint not found. Please check the route configuration."):e.response.status===500?alert("Internal server error. Please try again later."):alert("An error occurred. Please try again later.")):e.request?(console.error("No response received:",e.request),alert("No response from the server. Please check your connection.")):(console.error("Error in setting up request:",e.message),alert("Failed to send the request. Please try again later."))}).finally(()=>{console.log("toggleVisibility request completed")})},updateDocumentDisplayStatus(e,s){console.log("updateDocumentDisplayStatus called with:",{doc_id:e,employee_id:s}),this.form.doc_id=e,this.form.employee_id=s,console.log("Form data before request:",this.form),this.form.put(route("employee.document.service_letter_visible",e),{preserveScroll:!0,onSuccess:o=>{console.log("Success response:",o),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"Status Updated Successfully!")},onError:o=>{console.error("Error response:",o),this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong!")}})},downloadCertificate(){const e=document.getElementById("certificate"),s={margin:0,filename:"service_agreement_letter.pdf",image:{type:"jpeg",quality:.98},html2canvas:{scale:2},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};k().from(e).set(s).save().then(()=>{console.log("PDF downloaded successfully")}).catch(o=>{console.error("Error downloading PDF:",o)})},submit(){this.form.post(this.service_letter_data?route("employee.ServiceLetter.update"):route("employee.ServiceLetter.store"),{onSuccess:()=>{this.form.reset(),this.$root.showMessage("success",'<span class="text-success">Success</span><br/>',"A Record Was Created Successfully! ")},onError:()=>{this.form.reset("password","password_confirmation"),this.$root.showMessage("error",'<span class="text-danger">Error</span><br>',"Something went wrong! ")}})}}},V={class:"row"},q={class:"col-md-12"},x={class:"card mb-4"},U={class:"card-header pb-0"},j={class:"col-12 mb-4"},P={class:"row"},R={class:"col-1"},A=t("i",{class:"back-icon fas fa-arrow-left p-2"},null,-1),N={class:"col-11 d-flex justify-content-end"},F={class:"m-0 text-center"},M=t("h5",null,"Employee Service Letter",-1),I=t("p",null,"Manage Employee Service Letter",-1),O={class:"content"},Q={class:"qr-code"},B=["src"],z={class:"mt-2"},J=["disabled"],G=h("Cancel"),T=h("View"),W=t("div",null,null,-1),H=t("h1",null,null,-1);function K(e,s,o,X,r,d){const a=l("Link"),_=l("Editor"),f=l("AppLayout");return m(),u(f,null,{default:i(()=>[t("div",V,[t("div",q,[t("div",x,[t("div",U,[t("div",j,[t("div",P,[t("div",R,[c(a,{class:"back-button",href:e.route("employee.edit",o.employee.id)},{default:i(()=>[A]),_:1},8,["href"])]),t("div",N,[t("h5",F,p(o.employee.name),1)])])]),M,I,t("form",{id:"formAccountSettings",onSubmit:s[1]||(s[1]=v((...n)=>d.submit&&d.submit(...n),["prevent"]))},[t("div",O,[c(_,{modelValue:r.form.editorContent,"onUpdate:modelValue":s[0]||(s[0]=n=>r.form.editorContent=n),"api-key":"vw4ubmg1a3lka0446gbr2zl6hoyieci6cv2wpw8czi7giive",init:{plugins:["advlist","autolink","link","image","lists","charmap","preview","anchor","pagebreak","searchreplace","wordcount","visualblocks","code","fullscreen","insertdatetime","media","table","emoticons","help"],toolbar:"undo redo | styles | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | print preview media fullscreen | forecolor backcolor emoticons | help",menubar:"favs file edit view insert format tools table help"}},null,8,["modelValue"])]),t("div",Q,[t("img",{src:r.qrCodeImageUrl,alt:"QR Code"},null,8,B)]),t("div",z,[t("button",{type:"submit",class:"btn btn-main me-2",disabled:r.form.processing},p(o.service_letter_data?"Update":"Save"),9,J),c(a,{type:"button",href:e.route("employee.edit",r.form.employee_id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:i(()=>[G]),_:1},8,["href"]),o.service_letter_data?(m(),u(a,{key:0,type:"button",href:e.route("employee.ServiceLetter.view",this.employee.id),class:"btn btn-outline-danger",style:{"margin-right":"10px"}},{default:i(()=>[T]),_:1},8,["href"])):w("",!0),W]),H],32)])])])])]),_:1})}const re=D(L,[["render",K]]);export{re as default};
